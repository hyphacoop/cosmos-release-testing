---

name: Interchain Steps
on:
  workflow_call:
    inputs:
      runs-on-os:
        required: true
        type: string
      
jobs:
  test-run:
    runs-on: ${{ inputs.runs-on-os }}
    steps:
      # Get system info
      - run: ip addr
      - run: sudo dmidecode
      - run: df -h
      - run: free -m
      - run: uname -a
      - run: lsb_release -a
      - run: echo "GitHub branch is ${{ github.ref }}"
      - run: whoami
      - run: pwd
      - name: Check out repository code
        uses: actions/checkout@v3
      - name: Set up Docker
        uses: docker/setup-docker-action@v4
        with:
          daemon-config: |
            {
              "debug": true,
              "features": {
                "containerd-snapshotter": true
              }
            }
      - name: DEBUG
        if: always()
        run: |
          while [ ! -f /continue ]
          do
            sleep 1
          done
      - name: Start chain
        run: |
          cd interchaintests
          ./start_chain.sh gaia.json